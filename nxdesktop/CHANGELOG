ChangeLog:

nxdesktop-1.4.0-61

- Solved problem that makes the RDP session crashes when connected
  to a RDP 4 server like the original TS for Windows NT.
  TRSL042225.
  
- Modified the debug routines to avoid possible compilation problems
  gcc 2.95.

nxdesktop-1.4.0-60

- Changed debug entry on xwin.c to improve compatibility with gcc 2.95.3
  used on Suse 7.3

nxdesktop-1.4.0-59

- Solved bug on the debug code which was making nxdesktop segfault if
  the new XWIN operation debug is activated.
  
- Little code cleanning on xwin.c and orders.c

- Changed sequence of debug #ifdef's

nxdesktop-1.4.0-58

- Solved bug which was causing MS Visio 2002 to close the session as
  reported by Andreas Krause. 
  
NOTE: This will also probably solve the problem with his ERP. I'm waiting
      his answer on this matter.

nxdesktop-1.4.0-57

- Solved compilation warning when XWIN_DEBUG is active.

- Solved bug which was stoping nxdesktop properly behavior if
  "Use plain bitmaps" is enabled.
  
nxdesktop-1.4.0-56

- Debug code for the latest additions disabled.

nxdesktop-1.4.0-55

- Cosmetic change on the debug presentation routine.

- Better handling of the kbtype parameter read from the option file.

- Added debug code for the options parser.

- Changed the way the keymap file name is transfered to the correspondent
  variable and it's initialization. This was done to prevent a possible 
  crash due an empty kbtype parameter.

nxdesktop-1.4.0-54

- Updated keyboard translation table to be compatible with latest version
  used on nxclient.
  
- Updated NXTranslateKeymap to reflect those changes.

nxdesktop-1.4.0-53

- Changed warning message for unsupported keyboard option.

- Variable "command" is now freeded in case or error.

- In the previous version, for testing porpouses, the kbtype parameter
  was expected to still have the windows code attached. This was removed.
  
- As required, all keymap definitions supported on rdesktop are mapped
  to it's xkb counter-part.
 
NOTE: This version will not work with the current nxserver/nxclient.

nxdesktop-1.4.0-52

- Removed an duplicated call to xkeymap_init(). It didn't do any harm,
  just called twice.

- The keyboard parameters are now parsed from the "options" file. Also
  other relevant parameters like geometry are parsed from there.
  It scans the xkb parameter for an windows keymap equivalent. If one is
  not found, it falls back to the standard en_US, writing a warning 
  message in the server logs.
  It also still supports command line parameters for those it does not
  finds into the options file. In case of duplicity tough, the option 
  file has the priority.
  
NOTE: This version will work only with the latest nxserver 1.4.0-98 which
      was the last one made avaliable to me.
      For now the translation table is hardcoded based on Kryza's reference 
      file. Reading from /usr/NX/share/keyboards will probably better as 
      soon as it reaches it's final form.

nxdesktop-1.4.0-51

- The sound support is now disabled if NX transport is used.

nxdesktop-1.4.0-50

- Solved an error regarding a #ifdef that was making nxdesktop disable 
  the compressed cache and compressed bitmap orderings.

nxdesktop-1.4.0-49

- Solved text rendering problem. This closes the TRs
  "Certain text files are not displayed correctly in RDP sessions" and
  "nxdesktop shows errors when clipboard operations are performed"
  
NOTE: The problem on the second TR was actually caused by a bug on the
      text rendering process not a clipboard problem as first tought.

nxdesktop-1.4.0-48

- Disabled parameters parsing debug logs left enabled
  by mistake.

nxdesktop-1.4.0-47

- Corrected debug parameter of RDP5.

- Improved formating of RDP packet dumps.

- Added new debug flag, NXDESKTOP_ORDERS_DEBUG to help
  debug the RDP packets order process.

nxdesktop-1.4.0-46

- Added missing debug flag to avoid -kbtype message.

nxdesktop-1.4.0-45

- Added debug flag to remove a unnecessary warning message.

- The default Makeconf file had a debug flag. Removed.

nxdesktop-1.4.0-44

- Allocated size hints are now been correctly freed.

- Error, debug, information and warning messages were improved and
  standarized. Much more information on the categories above were
  added, specialy concerning the network communication layers:
  RDP, TCP, MCS, ISO and SEC. Each layer now has it's own debug
  activation flag such as: NXDESKTOP_MCS_DEBUG, NXDESKTOP_TCP_DEBUG,
  NXDESKTOP_ISO_DEBUG, NXDESKTOP_RDP_DEBUG, NXDESKTOP_XWIN_DEBUG,
  NXDESKTOP_SEC_DEBUG, NXDESKTOP_RDP5_DEBUG.
      
- Improved the error handling allowing nxdesktop to terminate 
  gracefully in the eventuality of communication problems.
  
NOTE: Those changes above were implemented previously in 
      nxdesktop-1.4.1 series and backported.

nxdesktop-1.4.0-43

- The text rendering is now fully compatible with NX and
  the newest RDP specifications avaliable.
  
- Changes on order.c to adequate to the modifications
  above.
  
- Small changes on variables types in cache.c and parallel.c
  to avoid compiler warnings.
  
- Removed CVS directories copied into nxdesktop tree by mistake.

nxdesktop-1.4.0-42

- Typo in CHANGELOG corrected.

- Two new paramenters added: -z and -P.
  -z enables the MPPC compression and  
  -P enables the persistent bitmap caching recently implemented.
  Both features are disabled by default.

- Changed PDU manipulation to work with the updated text rendering
  process.

- Text rendering re-written to solve the problem with GroupWise
  client and better compatibility with the latest changes on RDP5.
  
NOTE: The new text rendering process is working nicely but still 
      needs further optimization to improve performance and be 
      fully compatible with the text caching process.

nxdesktop-1.4.0-41

- A small change was made to minimize the problem with wrongly 
  wrapping text in GroupWise client when used on windows
  servers with the latest patches.
  
NOTE: This is not a real solution, just minimizes the problem.
      A definitive solution will be implemented on monday.

nxdesktop-1.4.0-40

- Solved problem with bitmaps on windows 2003 caused by the 
  changes on the caching process. 

nxdesktop-1.4.0-39

- Persistent bitmap cache implemented but inactive.
  It's been reported that the newest patch for windows
  servers can deny acesss if the RDP client does not report
  correct handling capability of bitmap cache version 2 for RDP5.
  This new bitmap cache was implemented but to avoid further 
  problems, it just reports correctly the new parameters 
  but the persistent cache is disabled.

nxdesktop-1.4.0-38

- Solved problem of RDP session hanging on windows servers 
  updated with the latest patches.
  This problem was caused by a change on the encryption
  procedures into the windows server.

nxdesktop-1.4.0-37

- Merged with nxdesktop-1.4.0-36-ADI1

- Solved problem with the clipboard when executed from windows
  client.
  
NOTE: Many thanks to Dario for his help with this clipboard
      problem.

nxdesktop-1.4.0-36

- Removed debug code forgot behind by mistake.

nxdesktop-1.4.0-35

- Solved the logo "blinking" when called from windows client.

nxdesktop-1.4.0-34

- Added code to avoid a possibly wrongly "Less than 8 bpp not currently 
  supported" error. The modification initializes the test variable with the
  current depth and issues a different error message if the pixmap array
  couldn't be allocated.

nxdesktop-1.4.0-33

- Message printed for the mock "-kbtype" message removed.

nxdesktop-1.4.0-32

- Added mock -kbtype parameter. Anything passed using it will be
  ignored and just a message will be printed.

nxdesktop-1.4.0-31

- Reversed the modifications made by 1.4.0-29-TOM2

nxdesktop-1.4.0-30

- Merged with 1.4.0-29-TOM1 and TOM2

nxdesktop-1.4.0-29

- Added the following keymaps:
  et
  is
  nl
  nl-be
  sv

- Updated the keymaps:
  de-ch
  fr-be
  ja
  sv

nxdesktop-1.4.0-28

- Aplied updates on mppc.c.

- Changed typecast on bitmap.c.

- Corrected logic error preventing connection error message to be shown.

- Corrected typecast in channels.c.

- Added missing copyright notice.

nxdesktop-1.4.0-27

- Solved bug that was causing messed bitmaps to be cached.

nxdesktop-1.4.0-26

- Solved bug on decompressing 1 bpp bitmaps bigger than 128 
  pixels.
  
- Fixed typo on connection error message.

- Fixed wrong typecast on secure.c.

nxdesktop-1.4.0-25

- Fixed memory leak on ui_create_gliph.

- Fixed typecast bug in channels.c.

- Bitmap handling completely re-written with special 
  decompressing routines for 1, 4 and 8 BPP.

- Added MPPC (Microsoft Point-to-Point Compression) support.

- Added printer status e redirection support.

- Added disk status and better redirection support.

- Changed RDP layer processing to add support to new PDU 
  messages.

- Changed ISO layer to prevent freeze caused by some windows 2003
  configurations.
  
- Changed secure layer to reflect changes on ISO layer.

- Better font handling.

- Advertizing capabilitites changed to reflect the new resources.

- RDP redirection now has lock control.

- Better color translation added.

- Added window resize support.

NOTE: The window resize is from server to client only. In theory
      it can be done from the client but will require to disconnect 
      and reconect with the new window size.
      It's expected RDP 6 to have dynamic resizing and seamless 
      mode implemented.
      The MPPC compression support is highly experimental and
      disabled for now by default.

nxdesktop-1.4.0-24

- Fixed possible problem if the Rects buffer overflows.

nxdesktop-1.4.0-23

- Fixed problem that can be caused if nxdesktop is called 
  by nxserver disabling RDP5.
  
NOTE: This is not a possibility today as we don't have such
      option now on the interface but it's a future bug squashed
      before it's born.

nxdesktop-1.4.0-22

- First implementation of reduced XFillRects now works.

- Fixed two typos in CHANGELOG

- Added define NXDESKTOP_USES_RECT_BUF to help evaluate the
  performance. If undefined, the old code is used.

NOTE: This first implementation was done in the solid XFillRect 
      which is, by far, the most used. Now that the necessary 
      flushing points are stablished, the others are easy to 
      implement if necessary, due it's very low incidence.

nxdesktop-1.4.0-21

- Redirection is now enabled to allow experimentation with it.

- Initial code to minimize the use of XFillRects in place.

NOTE: This modification is not working fully but if no windows 
      is dragged one can use it to test the statistics.

nxdesktop-1.4.0-20

- Merged code from 1.3.2 branch.

- Solved bug that prevented nxdesktop to run if called directly from 
  the command line.

NOTE: This bug was caused by a unforseen combination of having
      the compressed rdp bitmaps activated without the NX transport.      
